(function(jQuery){jQuery.fn.slideshow=function(options){var defaults={slideDuration:5000,fadeDuration:'slow',slidesClass:'slideClass',buttonsClass:'slideButton',nextClass:'nextClass',prevClass:'prevClass',pauseClass:'pauseClass',startClass:'startClass',reverseClass:'reverseClass',blockedClass:'blockedClass',lazyLoadClass:'lazyLoad',topZIndex:100,stayOn:!1,stopOnSelect:!0,direction:1};var slideshowId=0;options=jQuery.extend(defaults,options);var everyTime=function(duration,elem,fn){$(elem).data('timer',setTimeout(fn,duration));},stopTime=function(elem){clearTimeout($(elem).data('timer'));};return this.each(function(){var curslide=0,prevslide=0,num_slides=0,num_buttons=0,slide_width='0px',obj=jQuery(this);obj.data('slideshowed',true);slideshowId++;num_slides=obj.find('.'+options.slidesClass).eq(0).children('li').length;slide_width=obj.find('.'+options.slidesClass).eq(0).children('li').eq(0).outerWidth();options.topZIndex=num_slides;var button_selector='.'+options.buttonsClass+
' li a:not(".prevClass.nextClass")';num_buttons=obj.find(button_selector).length;obj.find(button_selector).eq(0).addClass('selected');obj.find('.'+options.slidesClass).each(function(){var i=0;jQuery(this).children('li').each(function(){i++;jQuery(this).css('z-index',(options.topZIndex-i));if(i>1){jQuery(this).css('display','none');}});});function doSlide(enqueueNextSlide){obj.find(button_selector).removeClass('selected').eq(curslide).addClass('selected');if(options.slideCallback){options.slideCallback(curslide);}obj.find('.'+options.slidesClass).each(function(){var childNodes=jQuery(this).children('li');var currentSlide=childNodes.eq(curslide);currentSlide.find('.'+options.lazyLoadClass).each(function(){var image=$(this);image.attr('src',image.data('src')).removeAttr('data-src').removeData('src');});currentSlide.animate({opacity:'show'},options.fadeDuration,enqueueNextSlide===true?startAnimation:undefined);childNodes.not(currentSlide).animate({opacity:'hide'},options.fadeDuration);});
fireEvent('slide');obj.data('currentSlide',curslide);}function moveSlide(direction,enqueueNextSlide){curslide=curslide+direction;prevslide=curslide-direction;switch(direction){case 1:if(curslide==num_slides){curslide=0;prevslide=(num_slides-1);}break;case-1:if(curslide<0){curslide=(num_slides-1);prevslide=0;}break;}doSlide(enqueueNextSlide);}function startAnimation(){everyTime(options.slideDuration,obj,function(){moveSlide(options.direction,true);});}fireEvent('slide');obj.data('currentSlide',curslide);obj.data('slides',num_slides);if(options.stayOn){curslide=(options.stayOn-1);doSlide();}else{startAnimation();fireEvent('onStart');}obj.find('.'+options.prevClass).click(function(){if(!$(this).hasClass('inactive')){stopTime(obj);moveSlide(-1);fireEvent('onPrev');fireEvent('onStop');}});obj.find('.'+options.nextClass).click(function(){if(!$(this).hasClass('inactive')){stopTime(obj);moveSlide(1);fireEvent('onNext');fireEvent('onStop');}});obj.find('.'+options.pauseClass).click(function(){
stopTime(obj);$(this).addClass(options.blockedClass);obj.find('.'+options.startClass).removeClass(options.blockedClass);});obj.find('.'+options.startClass).click(function(){startAnimation();$(this).addClass(options.blockedClass);obj.find('.'+options.pauseClass).removeClass(options.blockedClass);}).addClass(options.blockedClass);obj.find('.'+options.reverseClass).click(function(){options.direction=(options.direction*(-1));});obj.find(button_selector).click(function(){if(options.stopOnSelect){stopTime(obj);fireEvent('onStop');}curslide=obj.find(button_selector).index(this);doSlide();});function fireEvent(eventType){obj.trigger(eventType,{currentSlideId:curslide,totalSlides:num_slides});}obj.bind('selectSlide',function(ev,data){curslide=parseInt(data.slideId);doSlide();});obj.bind('start',function(ev){startAnimation();fireEvent('onStart');});obj.bind('stop',function(ev){stopTime(obj);fireEvent('onStop');});});};})(jQuery);;var WikiaPhotoGallerySlideshow={log:function(msg){$().log(msg,
'WikiaPhotoGallery:Slideshow');},init:function(params){var slideshow=$('#'+params.id),hash=slideshow.attr('data-hash'),crop=slideshow.attr('data-crop');var slideCallback=function(index){var item=slideshow.find('li').eq(index),img=item.find('img').first(),src=img.attr('data-src');if(src){if(crop){src=Wikia.Thumbnailer.getThumbURL(src,'image',parseInt(params.width),parseInt(params.height));img.css({width:params.width,height:params.height});}img.attr('src',src).removeAttr('data-src');}};slideCallback(0);slideshow.slideshow({buttonsClass:'wikia-button',nextClass:'wikia-slideshow-next',prevClass:'wikia-slideshow-prev',slideWidth:params.width,slidesClass:'wikia-slideshow-images',slideCallback:slideCallback,stayOn:!0});var lastInView=!1;$(window).on('scrollstop',function(){var scrollTop=$(window).scrollTop();var scrollBottom=scrollTop+$(window).height();var elemTop=slideshow.offset().top;var elemBottom=elemTop+slideshow.height();var inView=((scrollTop<=elemTop&&scrollBottom>=elemTop)||(
scrollTop<=elemBottom&&scrollBottom>=elemBottom));if(inView!=lastInView){if(inView){slideshow.trigger('start');}else{slideshow.trigger('stop');}}lastInView=inView;});slideshow.find('a.wikia-slideshow-image').click(function(ev){var linkType='lightbox';if(this.className.indexOf('link-internal')!==-1){linkType='link-internal';}else if(this.className.indexOf('link-external')!==-1){linkType='link-external';}Wikia.Tracker.track({action:'click',category:'article',label:'show-slideshow-'+linkType,trackingMethod:'analytics',value:0},{});});slideshow.find('.wikia-slideshow-addimage').click(function(e){if(WikiaPhotoGalleryView.forceLogIn()){return;}$.when(WikiaPhotoGalleryView.loadEditorJS(),WikiaPhotoGalleryView.ajax('getGalleryData',{hash:hash,articleId:wgArticleId})).then(function(loadEditorJSScripts,data){data=data[0];if(data&&data.info=='ok'){data.gallery.id=params.id;WikiaPhotoGallerySlideshow.log(data.gallery);WikiaPhotoGallery.showEditor({from:'view',gallery:data.gallery,target:$(e.target
).closest('.wikia-slideshow')});}else{WikiaPhotoGallery.showAlert(data.errorCaption,data.error);}});});slideshow.bind('slide',function(ev,data){var counter=slideshow.find('.wikia-slideshow-toolbar-counter');counter.text(counter.data('counter').replace(/\$1/,1+data.currentSlideId));});slideshow.find('.wikia-slideshow-images').bind({'mouseover':function(ev){$(this).addClass('hover');},'mouseout':function(ev){$(this).removeClass('hover');}});slideshow.find('.wikia-slideshow-toolbar').show();if(!WikiaPhotoGalleryView.isViewPage()){slideshow.find('.wikia-slideshow-addimage').hide();}this.log('#'+params.id+' initialized');}};;