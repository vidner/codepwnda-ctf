define('wikia.articleVideo.whichTransitionEvent',function(){return function(){var t;var el=document.createElement('fakeelement');var transitions={'transition':'transitionend','OTransition':'oTransitionEnd','MozTransition':'transitionend','WebkitTransition':'webkitTransitionEnd'};for(t in transitions){if(el.style[t]!==undefined){return transitions[t];}}};});;require(['mw','wikia.window','wikia.articleVideo.featuredVideo.jwplayer.onScroll','wikia.articleVideo.featuredVideo.jwplayer.videoFeedback','wikia.articleVideo.featuredVideo.attribution',require.optional('wikia.articleVideo.featuredVideo.jwplayer.instance')],function(mw,win,jwPlayerOnScroll,jwPlayerVideoFeedback,featuredVideoAttribution,playerInstance){var $featuredVideo=$('.featured-video'),$featuredVideoWrapper=$('.featured-video__wrapper'),$playerContainer=$('.featured-video__player-container');function run(){var unbindOnScrollEvents=jwPlayerOnScroll(playerInstance,$featuredVideo,$playerContainer);jwPlayerVideoFeedback(
playerInstance);featuredVideoAttribution(playerInstance);mw.hook('ve.activationComplete').add(function(){if(playerInstance){$featuredVideoWrapper.addClass('is-removed');playerInstance.remove();playerInstance=null;unbindOnScrollEvents();}});}if(playerInstance){run();}else{win.addEventListener('wikia.jwplayer.instanceReady',function(event){playerInstance=event.detail;win.removeEventListener('wikia.jwplayer.instanceReady',arguments.callee);run();});}});;define('wikia.articleVideo.featuredVideo.jwplayer.onScroll',['wikia.onScroll','wikia.articleVideo.whichTransitionEvent'],function(onScroll,whichTransitionEvent){return function(playerInstance,$featuredVideo,$playerContainer){var collapsingDisabled=!1,transitionEvent=whichTransitionEvent(),videoCollapsed=!1,$title=$('.featured-video__title'),$duration=$('.featured-video__time'),$closeBtn=$('.featured-video__close');playerInstance.trigger('onScrollStateChanged',{state:'inactive'});function isVideoInFullScreenMode(){return playerInstance
.getFullscreen();}function collapseVideo(videoOffset,videoHeight){var videoWidth=$playerContainer.outerWidth(),viewportWidth=$(window).width(),viewportHeight=$(window).height();collapsingDisabled=!1;videoCollapsed=!0;$featuredVideo.addClass('is-collapsed-ready');$playerContainer.css({'bottom':viewportHeight-videoOffset.top-videoHeight+$(window).scrollTop(),'right':viewportWidth-videoOffset.left-videoWidth,'width':videoWidth});setTimeout(function(){if(videoCollapsed){$featuredVideo.addClass('is-collapsed');}},0);}function uncollapseVideo(){videoCollapsed=!1;$playerContainer.css({'position':'','bottom':'','right':'','top':'','left':'','width':''});$featuredVideo.removeClass('is-collapsed is-collapsed-ready');playerInstance.resize();}function toggleCollapse(){if(isVideoInFullScreenMode()){return;}if(!collapsingDisabled||videoCollapsed){var scrollTop=$(window).scrollTop(),videoHeight=$featuredVideo.outerHeight(),videoOffset=$featuredVideo.offset(),scrollOffset=100,collapseOffset=
videoOffset.top+videoHeight-scrollOffset;if(scrollTop>collapseOffset&&!videoCollapsed){collapseVideo(videoOffset,videoHeight);playerInstance.trigger('onScrollStateChanged',{state:'active'});}else if(scrollTop<=collapseOffset&&videoCollapsed){uncollapseVideo();playerInstance.trigger('onScrollStateChanged',{state:'inactive'});}}}function closeButtonClicked(){playerInstance.pause(true);uncollapseVideo();collapsingDisabled=!0;playerInstance.trigger('onScrollStateChanged',{state:'closed'});}function updateTitleAndDuration(data){$title.text(data.item.title);$duration.text(data.item.duration);}function onVideoResized(event){if(event.propertyName==='width'){playerInstance.resize();$featuredVideo.removeClass('is-collapsed-ready');}}function unbindEvents(){$playerContainer[0].removeEventListener(transitionEvent,onVideoResized);onScroll.unbind(toggleCollapse);}if(transitionEvent){$playerContainer[0].addEventListener(transitionEvent,onVideoResized);}onScroll.bind(toggleCollapse);$closeBtn.click(
closeButtonClicked);playerInstance.on('play',function(){collapsingDisabled=!1;});playerInstance.on('relatedVideoPlay',updateTitleAndDuration);return unbindEvents;}});;define('wikia.articleVideo.featuredVideo.jwplayer.videoFeedback',['wikia.articleVideo.videoFeedbackBox'],function(VideoFeedbackBox){return function(playerInstance){var videoFeedbackBox;function videoFeedbackInit(event){if(event.position>=5&&!videoFeedbackBox&&playerInstance.getState()==='playing'){videoFeedbackBox=new VideoFeedbackBox('.featured-video .video-feedback',playerInstance);videoFeedbackBox.init();playerInstance.off('time',videoFeedbackInit)}}playerInstance.on('play',function(){if(videoFeedbackBox){videoFeedbackBox.show();}else{playerInstance.on('time',videoFeedbackInit);}});playerInstance.on('pause',function(){if(videoFeedbackBox){videoFeedbackBox.hide();}});playerInstance.on('complete',function(){if(videoFeedbackBox){videoFeedbackBox.hide();videoFeedbackBox=null;}});}});;define(
'wikia.articleVideo.featuredVideo.attribution',['wikia.mustache','wikia.articleVideo.featuredVideo.templates','JSMessages','wikia.tracker'],function(mustache,templates,msg,tracker){'use strict';var track=tracker.buildTrackingFunction({category:'featured-video',action:tracker.ACTIONS.CLICK,trackingMethod:'analytics'});return function(playerInstance){$('.featured-video__attribution-username, .featured-video__attribution-icon').click(function(){track({label:playerInstance.getPlaylistItem(0).username});});playerInstance.on('relatedVideoPlay',function(data){var attributionContainer=$('.featured-video__attribution-container'),item=data.item;if(item.username&&item.userUrl&&item.userAvatarUrl){var params={username:item.username,userUrl:item.userUrl,userAvatarUrl:item.userAvatarUrl,fromMsg:msg('articlevideo-attribution-from')},attributionHTML=mustache.render(templates['ArticleVideo_attribution'],params);if(attributionContainer.length){attributionContainer.replaceWith(attributionHTML);}else{$(
'.featured-video').after(attributionHTML);}$('.featured-video__attribution-username, .featured-video__attribution-icon').click(function(){track({label:item.username});});}else{attributionContainer.remove();}});}});;define('wikia.articleVideo.featuredVideo.templates',[],function(){'use strict';return{"ArticleVideo_attribution":
'<div class="featured-video__attribution-container"><img class="featured-video__attribution-avatar" src="{{userAvatarUrl}}"/><a class="featured-video__attribution-username" href="{{userUrl}}" target="_blank">{{fromMsg}} {{username}}</a><a class="featured-video__attribution-icon" href="{{userUrl}}" target="_blank">{{! DS icon: wds-icons-external-tiny }}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" class="wds-icon wds-icon-tiny"><path d="M9.75 6.75A.75.75 0 0 0 9 7.5v3H1.5V3h3a.75.75 0 0 0 0-1.5H.75a.75.75 0 0 0-.75.75v9c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75V7.5a.75.75 0 0 0-.75-.75"/><path d="M11.5 0H8a.5.5 0 0 0-.354.854l1.22 1.219-3.771 3.772a.749.749 0 1 0 1.06 1.06l3.772-3.771 1.219 1.22a.504.504 0 0 0 .545.108A.5.5 0 0 0 12 4V.5a.5.5 0 0 0-.5-.5"/></svg></a></div>',"done":"true"};});;define('wikia.articleVideo.videoFeedbackBox',['wikia.window','wikia.tracker'],function(window,tracker){var feedbackVisibleClass='visible',track=tracker.
buildTrackingFunction({category:'article-video',trackingMethod:'analytics'});function VideoFeedbackBox(selector,jwplayerInstance){this.feedback=$(selector);this.jwplayerInstance=jwplayerInstance;var closeFeedback=this.feedback.find('.video-feedback-close'),thumbUp=this.feedback.find('.video-thumb-up'),thumbDown=this.feedback.find('.video-thumb-down'),self=this;this.isActive=!1;closeFeedback.click(function(){if(self.jwplayerInstance){self.jwplayerInstance.trigger('videoFeedbackClosed');}else{track({action:tracker.ACTIONS.CLICK,label:'featured-video-feedback-closed'});}self.hide();self.isActive=!1;});thumbUp.click(function(){if(self.jwplayerInstance){self.jwplayerInstance.trigger('videoFeedbackThumbUp');}else{track({action:tracker.ACTIONS.CLICK,label:'featured-video-feedback-thumb-up'});}self.hide();self.isActive=!1;});thumbDown.click(function(){if(self.jwplayerInstance){self.jwplayerInstance.trigger('videoFeedbackThumbDown');}else{track({action:tracker.ACTIONS.CLICK,label:
'featured-video-feedback-thumb-down'});}self.hide();self.isActive=!1;});}VideoFeedbackBox.prototype.hide=function(){if(this.isActive){this.feedback.removeClass(feedbackVisibleClass);}};VideoFeedbackBox.prototype.show=function(){if(this.isActive){this.feedback.addClass(feedbackVisibleClass);}};VideoFeedbackBox.prototype.init=function(){this.isActive=!0;this.show();if(this.jwplayerInstance){this.jwplayerInstance.trigger('videoFeedbackImpression');}else{track({action:tracker.ACTIONS.IMPRESSION,label:'featured-video-feedback'});}};return VideoFeedbackBox;});;